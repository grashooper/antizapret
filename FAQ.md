# Часто задаваемые вопросы (FAQ)

## Общие вопросы

### Что такое AntiZapret?

AntiZapret - это система прозрачного обхода блокировок для локальной сети, которая работает на уровне роутера. Никакие настройки на клиентских устройствах не требуются.

### Какие системы поддерживаются?

- FreeBSD 13 и выше
- OPNsense 21 и выше
- pfSense (не тестировалось, но должно работать)

### Нужно ли настраивать каждое устройство отдельно?

Нет. Система работает на уровне роутера, поэтому все устройства в сети автоматически получают доступ к заблокированным ресурсам.

## Установка

### Какой метод установки выбрать?

Рекомендуем использовать автоматический скрипт установки - он найдет актуальные версии пакетов и настроит все автоматически. См. [QUICKSTART.md](QUICKSTART.md)

### Нужны ли права root?

Да, скрипт должен запускаться от имени root.

### Где взять Tor bridges?

1. Сайт: https://bridges.torproject.org/
2. Email: отправьте письмо на bridges@torproject.org с темой "get transport obfs4"
3. Telegram: @GetBridgesBot

### Какой тип мостов лучше использовать?

Рекомендуем использовать оба типа:
- obfs4 - более проверенный и стабильный
- webtunnel - новый, имитирует обычный HTTPS трафик

### Сколько мостов нужно?

Минимум 1 мост любого типа. Рекомендуется 2-3 моста каждого типа для надежности.

## Настройка

### Как узнать свой локальный IP адрес роутера?

Скрипт определит его автоматически. Обычно это:
- 192.168.1.1
- 192.168.0.1
- 10.0.0.1

### Как изменить конфигурацию Tor?

Отредактируйте файл `/usr/local/etc/tor/torrc` и перезапустите Tor:
```bash
nano /usr/local/etc/tor/torrc
pkill tor
/usr/local/bin/tor
```

### Как добавить новые мосты?

Отредактируйте `/usr/local/etc/tor/torrc`, добавьте строки с новыми мостами и перезапустите Tor.

### Как часто обновляется список заблокированных IP?

По умолчанию - ежедневно через cron. Можно настроить частоту в настройках cron.

## Использование

### Как проверить, что Tor работает?

```bash
ps aux | grep tor
tail -f /var/log/tor/notices.log
```

### Как проверить, что мосты работают?

В логах Tor (`/var/log/tor/notices.log`) должны быть сообщения о подключении к мостам:
```
[notice] Bootstrapped 100%: Done
```

### Весь трафик идет через Tor?

Нет. Только трафик к заблокированным IP адресам перенаправляется через Tor. Остальной трафик идет напрямую.

### Как обновить список заблокированных IP вручную?

```bash
/root/antizapret/antizapret.pl | tee /usr/local/www/ipfw_antizapret.dat | xargs pfctl -t AntiZapret_IPs -T add
```

## Проблемы и решения

### Скрипт не может найти локальный IP

Введите IP адрес вручную, когда скрипт спросит.

### Ошибка "Invalid argument" при создании алиаса

Увеличьте лимит таблиц файрвола:
1. `Firewall > Settings > Advanced`
2. `Firewall Maximum Table Entries` = 200000

### Tor не запускается

Проверьте логи:
```bash
tail -100 /var/log/tor/notices.log
```

Проверьте конфигурацию:
```bash
tor --verify-config
```

### Мосты не подключаются

1. Проверьте, что мосты введены правильно
2. Попробуйте получить новые мосты
3. Убедитесь, что obfs4proxy и webtunnel установлены:
   ```bash
   which obfs4proxy
   which webtunnel-tor-client
   ```

### Tor запускается, но сайты не открываются

1. Проверьте правила файрвола в OPNsense
2. Убедитесь, что алиас AntiZapret_IPs создан
3. Проверьте NAT правило для перенаправления на порт 9040
4. Убедитесь, что список IP загружен:
   ```bash
   pfctl -t AntiZapret_IPs -T show | head
   ```

### Не загружаются актуальные версии пакетов

Скрипт автоматически пытается найти последние версии. Если не получается, использует резервные URL. Вы можете вручную найти актуальные версии на https://pkg.freebsd.org/

### Как узнать версию FreeBSD?

```bash
uname -r
```

### Где находятся логи Tor?

```bash
/var/log/tor/notices.log
```

Если файл не существует, проверьте:
```bash
/usr/local/var/log/tor/notices.log
```

### Как полностью удалить AntiZapret?

```bash
pkill tor
rm -rf /root/antizapret
rm -f /usr/local/etc/rc.d/tor.sh
rm -f /usr/local/etc/tor/torrc
rm -f /usr/local/www/ipfw_antizapret.dat
rm -f /usr/local/opnsense/service/conf/actions.d/actions_antizapret.conf
pkg delete tor obfs4proxy-tor webtunnel-tor zstd
```

Затем удалите правила файрвола через веб-интерфейс.

## Производительность

### Влияет ли система на скорость интернета?

Только для заблокированных ресурсов, так как трафик идет через Tor. Остальной трафик не затрагивается.

### Можно ли ускорить работу?

1. Используйте больше мостов
2. Используйте obfs4 и webtunnel одновременно
3. Периодически обновляйте мосты на более быстрые

### Сколько ресурсов потребляет?

Tor обычно использует:
- CPU: 1-5%
- RAM: 50-100 MB
- Сеть: зависит от использования

## Безопасность

### Безопасно ли использовать Tor?

Да, Tor - это проверенная технология для обеспечения приватности.

### Видит ли провайдер, что я использую Tor?

С obfs4 и webtunnel провайдер видит только зашифрованный трафик, похожий на обычный HTTPS.

### Логируются ли мои запросы?

Скрипт AntiZapret не логирует запросы. Tor логирует только техническую информацию (подключения к мостам, ошибки).

### Нужно ли обновлять мосты?

Рекомендуется обновлять мосты раз в несколько месяцев или если они перестали работать.

## Дополнительно

### Где получить помощь?

1. Проверьте эти FAQ
2. Прочитайте [INSTALL.md](INSTALL.md)
3. Проверьте логи Tor
4. Создайте issue на GitHub

### Как внести вклад в проект?

Pull requests приветствуются! См. репозиторий на GitHub.

### Где найти исходный код?

https://github.com/Limych/antizapret

### Какая лицензия?

MIT License - см. файл LICENSE
